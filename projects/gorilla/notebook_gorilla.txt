### 2010-03-27 ###

mysql> select pattern,count(*) from counts_sites where has_cpg=0 and gap=0 group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H   |     5137 |
| C.GH    |    76222 |
| CGH     |  7461546 |
| G.CH    |   170475 |
| H.CG    |    54708 |
+---------+----------+
5 rows in set (1 min 48.44 sec)

mysql> select pattern,count(*) from counts_sites where has_cpg=0 and gap=1 group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H   |    24897 |
| C.GH    |   335683 |
| G.CH    |   325918 |
| H.CG    |    62089 |
+---------+----------+
4 rows in set (16.88 sec)

mysql> select tree_pattern,count(*) from counts_genes group by tree_pattern;
+--------------+----------+
| tree_pattern | count(*) |
+--------------+----------+
| C.GH         |     3446 |
| G.CH         |     8700 |
| H.CG         |     2910 |
+--------------+----------+
3 rows in set (0.20 sec)

R scripts: 

> source("../../scripts/collect_sitewise.R")
> gor.sites = get.vector(con=con,query="select * from gj1_gor_57.counts_sites")


### 2010-03-29 ###

mysql> select tree_pattern,count(*) from counts_genes group by tree_pattern;
+--------------+----------+
| tree_pattern | count(*) |
+--------------+----------+
| C.GH         |     3446 |
| G.CH         |     8700 |
| H.CG         |     2911 |
+--------------+----------+
3 rows in set (0.32 sec)

mysql> select pattern,count(*) from counts_sites where type!="gap" group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H   |     8172 |
| C.GH    |    96195 |
| CGH     |  7906589 |
| G.CH    |   206369 |
| H.CG    |    71583 |
+---------+----------+
5 rows in set (2 min 13.20 sec)

mysql> select pattern,count(*) from counts_sites where type="gap" group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H   |    31606 |
| C.GH    |   364830 |
| G.CH    |   353035 |
| H.CG    |    70406 |
+---------+----------+
4 rows in set (19.67 sec)

mysql> select pattern,count(*) from counts_sites where type="synonymous" group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H   |      878 |
| C.GH    |    46410 |
| G.CH    |    84857 |
| H.CG    |    41803 |
+---------+----------+
4 rows in set (10.12 sec)

mysql> select pattern,count(*) from counts_sites where type="nonsynonymous" group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H   |     7294 |
| C.GH    |    49785 |
| G.CH    |   121512 |
| H.CG    |    29780 |
+---------+----------+
4 rows in set (10.18 sec)


### 2010-04-15 ###

Ran the pipeline including the orangutan as an outgroup:

mysql> select pattern,count(*) from outgroup_sites where type!='gap' group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H.O |      739 |
| C.G.HO  |     2166 |
| C.GHO   |    63305 |
| C.H.GO  |     1302 |
| C.O.GH  |     4631 |
| CG.HO   |     5421 |
| CGHO    |  6783906 |
| CH.GO   |    21183 |
| CO.GH   |    13317 |
| G.CHO   |   149093 |
| G.H.CO  |     2395 |
| G.O.CH  |     8291 |
| H.CGO   |    53608 |
| H.O.CG  |     3173 |
| O.CGH   |   260112 |
+---------+----------+
15 rows in set (1 min 48.19 sec)


# SQL query to merge sites tables:
mysql> select * FROM counts_sites a, outgroup_sites b WHERE a.node_id=b.node_id AND a.aln_position=b.aln_position and a.type!='gap' limit 10;


 -> Look at outgroup patterns to resolve mutation events:

mysql> select a.pattern AS hgc,b.pattern AS orang,count(*) FROM counts_sites a, outgroup_sites b WHERE a.node_id=b.node_id AND a.aln_position=b.aln_position and a.type!='gap' and b.type!='gap' group by a.pattern,b.pattern;
+-------+---------+----------+
| hgc   | orang   | count(*) |
+-------+---------+----------+
| C.G.H | C.G.H.O |      171 |
| C.G.H | C.G.HO  |      257 |
| C.G.H | C.H.GO  |      135 |
| C.G.H | G.H.CO  |      421 |
| C.GH  | C.GHO   |     3671 |
| C.GH  | C.O.GH  |      669 |
| C.GH  | CO.GH   |     3442 |
| CGH   | CGHO    |   229016 |
| CGH   | O.CGH   |     7668 |
| G.CH  | CH.GO   |     1167 |
| G.CH  | G.CHO   |    19519 |
| G.CH  | G.O.CH  |      847 |
| H.CG  | CG.HO   |      206 |
| H.CG  | H.CGO   |     2251 |
| H.CG  | H.O.CG  |      159 |
+-------+---------+----------+
15 rows in set (2 min 39.21 sec)


 -> All outgroup patterns:

mysql> select pattern,count(*) from outgroup_sites group by pattern;
+---------+----------+
| pattern | count(*) |
+---------+----------+
| C.G.H.O |     3177 |
| C.G.HO  |    12407 |
| C.GHO   |   236902 |
| C.H.GO  |     5566 |
| C.O.GH  |    22814 |
| CG.HO   |    22205 |
| CGHO    |  6779623 |
| CH.GO   |    52886 |
| CO.GH   |   153245 |
| G.CHO   |   429515 |
| G.H.CO  |    14755 |
| G.O.CH  |    32130 |
| H.CGO   |    97686 |
| H.O.CG  |     9427 |
| O.CGH   |   585610 |
+---------+----------+
15 rows in set (1 min 57.26 sec)


mysql> select parameter_set_id,count(*) from stats_sites where omega_upper < 99 AND type IN ("positive3","positive4") group by parameter_set_id;
+------------------+----------+
| parameter_set_id | count(*) |
+------------------+----------+
|                1 |       20 |
|                2 |      116 |
|                3 |       10 |
|                4 |       40 |
|                5 |      712 |
|                6 |      985 |
|                7 |       57 |
|                8 |      762 |
|                9 |       11 |
|               10 |     7679 |
|               11 |     3492 |
+------------------+----------+
11 rows in set (1 min 51.32 sec)


## Running global dN/dS on filtered alignments w/ 100 genes:

mysql> select * from stats_dnds;
+---------+------------------+-----------+-----------+-----------+-----------+--------+---------------+------------------+---------+-----------+------------------------------+------------------------------+-----------------------------------------------+----------------------------+
| data_id | parameter_set_id | dnds_Ggor | dnds_Hsap | dnds_Mmul | dnds_Ppyg | method | n_gappy_sites | n_nongappy_sites | n_sites | n_species | newick_dnds                  | newick_ds                    | newick_species                                | newick_t                   |
+---------+------------------+-----------+-----------+-----------+-----------+--------+---------------+------------------+---------+-----------+------------------------------+------------------------------+-----------------------------------------------+----------------------------+
|      44 |                0 |      NULL |      NULL |      NULL |      NULL | paml   |          NULL |             NULL |  275673 |         2 | (Ggor:0.2932,Hsap:0.2932)3;
 | (Ggor:0.0142,Hsap:0.0000)3;
 | (Ggor,Hsap);
                                 | (Ggor:0.022,Hsap:0.000)3;
 |
|      45 |                0 |   0.27491 |   0.31409 |      NULL |      NULL | paml   |          NULL |             NULL |  278355 |         3 | NULL                         | NULL                         | ((Ggor#1,Hsap#2),Ppyg);
                      | NULL                       |
|      46 |                0 |     0.251 |   0.31632 |      NULL |      NULL | paml   |          NULL |             NULL |  274290 |         4 | NULL                         | NULL                         | (((Ggor#1,Hsap#2),Ppyg),Mmul);
               | NULL                       |
|      47 |                0 |   0.22245 |   0.28649 |      NULL |      NULL | paml   |          NULL |             NULL |  265173 |         5 | NULL                         | NULL                         | ((((Ggor#1,Hsap#2),Ppyg),Mmul),Cjac);
        | NULL                       |
|      48 |                0 |    0.2449 |   0.27046 |      NULL |      NULL | paml   |          NULL |             NULL |  281211 |         6 | NULL                         | NULL                         | (((((Ggor#1,Hsap#2),Ppyg),Mmul),Cjac),Tsyr);
 | NULL                       |
+---------+------------------+-----------+-----------+-----------+-----------+--------+---------------+------------------+---------+-----------+------------------------------+------------------------------+-----------------------------------------------+----------------------------+
5 rows in set (0.00 sec)


mysql> select * from stats_dnds;
+---------+------------------+-----------+-----------+-----------+-----------+--------+---------------+------------------+---------+-----------+------------------------------+------------------------------+-----------------------------------------------+----------------------------+
| data_id | parameter_set_id | dnds_Ggor | dnds_Hsap | dnds_Mmul | dnds_Ppyg | method | n_gappy_sites | n_nongappy_sites | n_sites | n_species | newick_dnds                  | newick_ds                    | newick_species                                | newick_t                   |
+---------+------------------+-----------+-----------+-----------+-----------+--------+---------------+------------------+---------+-----------+------------------------------+------------------------------+-----------------------------------------------+----------------------------+
|      54 |                0 |      NULL |      NULL |      NULL |      NULL | paml   |          NULL |             NULL | 2028357 |         2 | (Ggor:0.2852,Hsap:0.2852)3;
 | (Ggor:0.0147,Hsap:0.0000)3;
 | (Ggor,Hsap);
                                 | (Ggor:0.022,Hsap:0.000)3;
 |
|      55 |                0 |   0.24758 |   0.30979 |      NULL |      NULL | paml   |          NULL |             NULL | 2072574 |         3 | NULL                         | NULL                         | ((Ggor#1,Hsap#2),Ppyg);
                      | NULL                       |
|      56 |                0 |   0.24098 |   0.29361 |      NULL |      NULL | paml   |          NULL |             NULL | 2051910 |         4 | NULL                         | NULL                         | (((Ggor#1,Hsap#2),Ppyg),Mmul);
               | NULL                       |
|      57 |                0 |   0.23356 |   0.27494 |      NULL |      NULL | paml   |          NULL |             NULL | 2009790 |         5 | NULL                         | NULL                         | ((((Ggor#1,Hsap#2),Ppyg),Mmul),Cjac);
        | NULL                       |
|      58 |                0 |   0.24079 |   0.26063 |      NULL |      NULL | paml   |          NULL |             NULL | 2000667 |         6 | NULL                         | NULL                         | (((((Ggor#1,Hsap#2),Ppyg),Mmul),Cjac),Tsyr);
 | NULL                       |
+---------+------------------+-----------+-----------+-----------+-----------+--------+---------------+------------------+---------+-----------+------------------------------+------------------------------+-----------------------------------------------+----------------------------+
5 rows in set (0.01 sec)


### 2010-07-12 - Published estimates of primate dN/dS

> See e-mail to Bryndis.


### 2010-08-07 - Finally some of the genomewide dN/dS estimates worked!!!

mysql> select * from stats_dnds order by data_id;
+---------+------------------+-------+--------------+-----------+-----------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+--------------------+-------+--------+---------+----------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------+---------------------+-------------------------+---------------------+---------------------+---------------------+
| data_id | parameter_set_id | Mgene | branch_model | cleandata | dnds_Background | dnds_Cfam | dnds_Ggor | dnds_Hsap | dnds_Mmul | dnds_Mmus | dnds_Ppyg | dnds_Ptro | foreground_species | label | method | n_genes | n_sites  | n_species | newick_dnds                                                                                                                                   | newick_ds                                                                                                                                     | newick_species                                  | newick_t                                                                                                                          | remove_funky_codons | target_alignment_length | unroot_species_tree | work_finished       | work_started        |
+---------+------------------+-------+--------------+-----------+-----------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+--------------------+-------+--------+---------+----------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------+---------------------+-------------------------+---------------------+---------------------+---------------------+
|     101 |                0 |    -1 |            1 |         0 |            NULL |      NULL |      0.32 |    0.2015 |     0.282 |     1e-04 |    0.2947 |    0.2826 | 9606,9593          | 101   | paml   |      37 |   100521 |         7 | ((((((Ptro:0.2826,Hsap:0.2015)13:0.1180,Ggor:0.3200)12:0.1705,Ppyg:0.2947)11:0.1414,Mmul:0.2820)10:0.1733,Cjac:0.1963)9:0.1682,Mmus:0.0001)8; | ((((((Ptro:0.0061,Hsap:0.0060)13:0.0016,Ggor:0.0085)12:0.0077,Ppyg:0.0150)11:0.0110,Mmul:0.0392)10:0.0218,Cjac:0.0635)9:0.3620,Mmus:0.0275)8; | ((((((Ptro,Hsap),Ggor),Ppyg),Mmul),Cjac),Mmus); | ((((((Ptro:0.009,Hsap:0.008)13:0.002,Ggor:0.013)12:0.010,Ppyg:0.023)11:0.013,Mmul:0.059)10:0.028,Cjac:0.084)9:0.455,Mmus:0.025)8; |                   1 |                  100000 |                   0 | 2010-08-06 10:19:57 | 2010-08-06 09:57:01 |
|     102 |                0 |    -1 |            1 |         0 |            NULL |      NULL |    0.3363 |    0.2705 |    0.3385 |     1e-04 |     0.321 |    0.3073 | 9606,9593          | 102   | paml   |     208 |   500799 |         7 | ((((((Ptro:0.3073,Hsap:0.2705)13:0.2127,Ggor:0.3363)12:0.2014,Ppyg:0.3210)11:0.1761,Mmul:0.3385)10:0.2101,Cjac:0.2753)9:0.1979,Mmus:0.0001)8; | ((((((Ptro:0.0069,Hsap:0.0070)13:0.0018,Ggor:0.0117)12:0.0094,Ppyg:0.0212)11:0.0131,Mmul:0.0441)10:0.0248,Cjac:0.0678)9:0.3916,Mmus:0.0319)8; | ((((((Ptro,Hsap),Ggor),Ppyg),Mmul),Cjac),Mmus); | ((((((Ptro:0.011,Hsap:0.010)13:0.002,Ggor:0.019)12:0.012,Ppyg:0.033)11:0.016,Mmul:0.070)10:0.033,Cjac:0.099)9:0.509,Mmus:0.028)8; |                   1 |                  500000 |                   0 | 2010-08-06 11:19:31 | 2010-08-06 09:57:07 |
|     103 |                0 |    -1 |            1 |         0 |            NULL |      NULL |    0.3471 |    0.2967 |    0.3355 |     1e-04 |    0.2929 |    0.3175 | 9606,9593          | 103   | paml   |     426 |  1002141 |         7 | ((((((Ptro:0.3175,Hsap:0.2967)13:0.2077,Ggor:0.3471)12:0.1995,Ppyg:0.2929)11:0.1866,Mmul:0.3355)10:0.2084,Cjac:0.2816)9:0.1884,Mmus:0.0001)8; | ((((((Ptro:0.0065,Hsap:0.0065)13:0.0019,Ggor:0.0114)12:0.0095,Ppyg:0.0199)11:0.0130,Mmul:0.0457)10:0.0247,Cjac:0.0699)9:0.4253,Mmus:0.0196)8; | ((((((Ptro,Hsap),Ggor),Ppyg),Mmul),Cjac),Mmus); | ((((((Ptro:0.010,Hsap:0.010)13:0.002,Ggor:0.018)12:0.012,Ppyg:0.029)11:0.016,Mmul:0.072)10:0.032,Cjac:0.102)9:0.535,Mmus:0.017)8; |                   1 |                 1000000 |                   0 | 2010-08-06 12:39:39 | 2010-08-06 09:57:07 |
|     104 |                0 |    -1 |            1 |         0 |            NULL |      NULL |      NULL |      NULL |      NULL |      NULL |      NULL |      NULL | 9606,9593          | 104   | paml   |    2891 |  5001930 |      NULL | NULL                                                                                                                                          | NULL                                                                                                                                          | NULL                                            | NULL                                                                                                                              |                   1 |                 5000000 |                   0 | NULL                | 2010-08-06 09:57:07 |
|     105 |                0 |    -1 |            1 |         0 |            NULL |      NULL |    0.3223 |    0.2559 |    0.3275 |    0.1508 |    0.2825 |    0.2706 | 9606,9593          | 105   | paml   |    7173 | 10002027 |         7 | ((((((Ptro:0.2706,Hsap:0.2559)13:0.1794,Ggor:0.3223)12:0.1873,Ppyg:0.2825)11:0.1651,Mmul:0.3275)10:0.1950,Cjac:0.2689)9:0.1619,Mmus:0.1508)8; | ((((((Ptro:0.0067,Hsap:0.0065)13:0.0021,Ggor:0.0111)12:0.0097,Ppyg:0.0213)11:0.0138,Mmul:0.0470)10:0.0252,Cjac:0.0715)9:0.1497,Mmus:0.3096)8; | ((((((Ptro,Hsap),Ggor),Ppyg),Mmul),Cjac),Mmus); | ((((((Ptro:0.010,Hsap:0.009)13:0.002,Ggor:0.017)12:0.012,Ppyg:0.031)11:0.016,Mmul:0.072)10:0.032,Cjac:0.101)9:0.177,Mmus:0.358)8; |                   1 |                10000000 |                   0 | 2010-08-06 19:51:20 | 2010-08-06 09:57:09 |
|     999 |                0 |    -1 |            2 |         0 |            NULL |      NULL |      NULL |      NULL |      NULL |      NULL |      NULL |      NULL | 9606,9593          | 999   | paml   |      37 |    75699 |      NULL | NULL                                                                                                                                          | NULL                                                                                                                                          | NULL                                            | NULL                                                                                                                              |                   1 |                 6000000 |                   0 | NULL                | 2010-08-06 09:23:08 |
+---------+------------------+-------+--------------+-----------+-----------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+--------------------+-------+--------+---------+----------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------+---------------------+-------------------------+---------------------+---------------------+---------------------+
6 rows in set (0.00 sec)

Git commit #: 
