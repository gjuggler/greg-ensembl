### 2010-03-31 ###

Examples of experimental validation in mammals:
 - Sawyer et al. 2005 PNAS - Trim5alpha
   - http://www.pnas.org/content/102/8/2832.full
   -> TRIM5 (ENSG00000132256)
 - Ivarsson et al. 2002 J Biol Chem - Glutathione transferase
   - http://www.jbc.org/content/278/10/8733.full
   -> GSTM1 (ENSG00000134184)
 - Elde et al. 2009 Nature - Protein kinase R (pos-sel), eIF2 (no pos-sel)
   - Noted that other members of the same kinase family do not experience similar levels of
     pos-sel.
   -> EIF2AK2 (ENSG00000055332)
   -> EIF2S1 (ENSG00000134001)
 - Gupta et al. 2009 PLoS Pathogens - Human Tetherin/BST-2/CD317
   - http://dx.doi.org/10.1371/journal.ppat.1000443
   - http://www.citeulike.org/user/gjuggler/article/7026702
   - The gene has a single residue shift (at a pos-sel site)  that substantially impacts on
     sensitivity to HIV-1 Vpu.
   -> BST2 (ENSG00000130303)

Experimental validation elsewhere:
 - Bielawski et al. 2004 PNAS - proteorhodopsin - bacterial


Speculation without validation:
 - Wlasiuk et al. 2009 Mol Biol Evol - Toll-like recepfor 5 (TLR5)
 - Weadick and Chang 2009 Mol Biol Evol - BY Lens Crystallin (pretty crap)

Reviews / summaries:
 - Yang 2005 PNAS - The power of phylogenetic comparison in revealing protein function
 - Oleksyk et al. Phil Trans R Soc B 2010 - Genome-wide scans for footprints of natural selection




# Nice quote from Bielawski et al. 2004:

Application of statistical methods has led to the discovery of many
genes evolving under positive selection, with the majority relating to
the immune response or sexual reproduction (20, 31). In such cases,
these genes are typically called .fast. genes, because the
evolutionary arms-race between host and parasite, or the evolutionary
forces associated with sexual competition or conflict, leads to rapid
evolution under diversifying selection. An alternative model exists
for .directional. evolution for altered function in a novel
environment; this model is strongly influenced by the extensive study
of adaptive alteration of oxygen affinity in vertebrate hemoglobins
(32, 33). Under the globin model, directional evolution proceeds by
rare adaptive modifications of the protein at one or very few key
positions, with all other substitutions being functionally neutral
(32, 33). Indeed, direct examination of functional change in response
to site-directed mutagenesis indicates that a large phenotypic change
can arise in a variety of proteins, including PRs, from just one or a
few amino acid changes (7, 30, 34). However, the results of
site-directed mutagenesis do not constitute a proof of a hypothesis of
natural selection. Observing a functional change in response to a
substitution by site-directed mutagenesis does not mean that if an
organism bore such a substitution it was subject to natural
selection. Likewise, the lack of a detectable effect from a
substitution is not proof that such a change did not have fitness
consequences in the natural environment. All one can do is evaluate
and refine a hypothesis about patterns and mechanisms of adaptive
molecular evolution in light of all of the available evidence. In the
case of PRs, the combination of phylogeny-based statistical analysis
and site-directed mutagenesis suggested that substitutions with small
or no measurable effect on absorption maxima might have had important
fitness consequences in the oceanic environment. Although we suspect
that much evolutionary change in proteins such as PRs is indeed
neutral, we argue that the globin model for directional evolution,
i.e., assuming that changes at other than the major-effect sites are
selectively neutral (32, 33), should be treated cautiously.


# List from Oleksyk et al. 2010 - selection in human populations

chromo- some	    gene      location		author		discovered by	test(s)		population(s)	found by scan (same locus)   found by scan (nearby locus)
1	FY	    1q21.q22  Hamblin & Di Rienzo (2000)	frequency spectrum, population differentiation	Fay and Wu's H, FST	     Africans		   by 50 kb (Frazer et al. 2007)
1	AGT	    1q42.q43  Nakajima et al. (2004)		unusual LD	    tight LD   Africans		    
1	ASPM	    1q31      Mekel-Bobrov et al. (2005)	comparative methods	  Ka/Ks			    World   
2	LCT	    2q21      Bersaglieri et al. (2004)		unusual LD  iHs, EHH	  Europeans, World	    Frazer et al. (2007); Nielsen et al. (2005); Voight et al. (2006)  
2	CAPN10	    2q37.3    Fullerton et al. (2002)		population differences	  FST	     Africans versus non-African	  
3	CCR5	    3p21.31   Stephens et al. (1998)		population differences	  FST and low heterozygosity			  Europeans  Oleksyk et al. (2008)  
4	ADH1B	    4q21.q23  Osier et al. (2004, 2002)		unusual LD, and population differences					  LD, FST    Asians  Frazer et al. (2007)  by 100 kb (Voight et al. 2006)
5	IL13	    5q31      Sakagami et al. (2004)		population differences	   FST						  World		     by 200 kb (Oleksyk et al. 2008)
5	IL4	    5q31.1    Rockman et al. (2003)		population differences	   FST						  World			by 200 kb (Oleksyk et al. 2008)
6	HFE	    6p21.3    Toomajian & Kreitman (2002)	multiple   Ka/Ks, LD, FST  Asians								by 100 kb (Voight et al. 2006)
6	TRPV6	    7q33.q34  Akey et al. (2006)   low diversity and frequency spectrum	   Tajima's D, and low diversity					Africans	  at different coordinates (Carlson et al. 2005)
7	CYP3A5	    7q21.1    Thompson et al. (2004, 2006)	 frequency spectrum	   Tajima's D  Europeans, Asians					Carlson et al. (2005); Oleksyk et al. (2008)	    by 200 kb (Voight et al. 2006)
7	FOXP2	    7q31      Enard et al. (2002)    comparative methods   Ka/Ks	   World    Oleksyk et al. (2008)					
8	MCPH1	    8p23.1    Evans et al. (2006a)   comparative methods   Ka/Ks	   World    Bustamante et al. (2005) (negative)				
8	NAT2	    8p22      Patin et al. (2006)    unusual LD	 REHH	   Europeans		    
9	CDK5RAP2    9q33.2    Evans et al. (2006b)   comparative methods   Ka/Ks		    World		
10	FGFR2	    10q26     Goriely et al. (2003); Goriely et al. (2005)			    n.a.		distribution of mutations in sperm skewed  World   
11	DRD4	    11p15.5   Ding et al. (2002); Wang et al. (2004)				    unusual LD		LD	     World	     
11	HBB	    11p15.5   Ayodo et al. (2007)      population differences			    FST	    Africans		     by 100 kb (Frazer et al. 2007)
11	MMP3	    11q22.3   Rockman et al. (2004)    low diversity and population differences	    FST, low heterozygosity,	     Europeans		  
11	CASP12P1    11q22.3   Xue et al. (2006)	       frequency spectrum and unusual LD	    Tajima's D, Fay and Wu's H, LD   World		   
13	CENPJ	    13q12.12  Evans et al. (2006b)     comparative methods    Ka/Ks   World	    Frazer et al. (2007)     by 200 kb (Voight et al. 2006)
15	SLC24A5	    15q21.1   Lamason et al. (2005)    low diversity	      Low heterozygosity    Europeans	  Sabeti et al. (2007)	       by 80 kb (Voight et al. 2006)
16	MC1R	    16q24.3   Makova & Norton (2005); Makova et al. (2001)    low diversity and frequency spectrum	 pi, theta, Fu and Li F	  Africans, Europeans, Asians   
17	TTL.6	    17q21.32  Chen et al. 2006)	      comparative methods     Ka/Ks	    World			 by 50 kb (Akey et al. 2002)
X	DMD	    Xp21.2    Nachman & Crowell (2000)		  reduced variation and unusual LD			 HKA, LD  non-African  Frazer et al. (2007)  
X	CD40LG (TNFSF5)	      X26     Sabeti et al. (2002)	  unusual LD	    EHH		Africans		      
X	FIX    Xq27.1.q27.2   Harris & Hey (2001)   low diversity and frequency spectrum	low diversity, Tajima's D     World   
X	G6PD   Xq28	      Sabeti et al. (2002); Tishkoff et al. (2001)	unusual LD	EHH	       Africans		      
X	MAOA   Xp11.3	      Andres et al. (2004); Gilad et al. (2002)		comparative methods	       Ka/Ks		      World   


### 2010-04-12 ###

Rules from Pollard et al. Genome Research 2010: >=3 primates, >=2 glires, >=1 outgroup (any other).

> wget http://compgen.bscb.cornell.edu/projects/mammal-psg/gene-definitions.txt
> mv gene-definitions.txt kosiol-gene-definitions.txt
> mysql --user=genome --host=genome-mysql.cse.ucsc.edu -A -e "select * from hg18.mammalPsg;" > kosiol-gene-table.tsv

> perl ~/src/greg-ensembl/scripts/get_genes_by_location.pl < ../projects/2xmammals/psg_overlaps/kosiol_locs.txt > ../projects/2xmammals/psg_overlaps/kosiol_ensg.txt

R> a = read.delim(file="kosiol-gene-definitions.txt",sep="\t",header=T,stringsAsFactors=F)
R> b = read.delim(file="kosiol-gene-table.tsv",sep="\t",header=T,stringsAsFactors=F)
R> mapped = read.delim(file="kosiol_ensg.txt",header=F)
R> sum(is.na(mapped2))
[1] 4556

 -> Try using Galaxy to lift over old Kosiol coordinates to new ones.

> wget http://main.g2.bx.psu.edu/datasets/0465e4b2344a83a3/display?to_ext=bed

> sum(!is.na(mapped))
[1] 16460

 -> Much better!

### 2010-04-13 ###

Goal: analyze overlap between our PSGs and other published datasets.

Chosen publications:
 -> Kosiol et al. 2008, Patterns of positive selection ...
  - http://www.citeulike.org/user/gjuggler/article/3072668
  - Files: 
    > kosiol-gene-definitions.txt
    > kosiol-gene-table.tsv
 -> Nielsen et al. 2005, A scan for positively selected ...
  - http://www.citeulike.org/user/gjuggler/article/365149
  - Files:
    > nielsen-genes.csv (converted from XLS)
 -> Clark et al. 2003, Inferring nonneutral evolution from ...
  - http://www.citeulike.org/user/gjuggler/article/669134
  - Files:
    > clark-genes.tsv
 -> Sabeti et al. 2009, 
  - Files:
    > sabeti-genes.txt


Approach:
 - Score each gene. Possible scores:
   - Gene-wide dn/ds (SLR m0)
   - Lower bound of dn/ds (hyphy dnds_lo)
   - PSC count (weak.psc.count)
   - Maximum value of signed LRT within gene
 - Do ROC plots, where truth = existence in one of the above lists. Plot TP vs TN for each dataset.


> wget ftp://ftp.ncbi.nih.gov/gene/DATA/GENE_INFO/Mammalia/Homo_sapiens.gene_info.gz
R> gene.info = read.delim("Homo_sapiens.gene_info",sep="\t",header=F,stringsAsFactors=F)
R> names(gene.info) = c("tax_id","GeneID","Symbol","LocusTag","Synonyms","dbXrefs","chromosome","map.location","description","type","symbol.from.nomenclature","full.name.from.nomenclature","nomenclature.status","other.designations","modification.date")

R> sabeti.genes = read.delim("sabeti-genes.txt",header=F,stringsAsFactors=F,col.names='id')


Initial results:

Using m.dnds.m0 as the score:

> roc.summary(roc.nielsen)
         score   tp         tn   p     n thresh
10668 0.643387 0.10 0.01055570  12   121   0.10
6059  0.496072 0.25 0.03594173  30   412   0.25
1738  0.346102 0.50 0.10677833  60  1224   0.50
2733  0.237809 0.75 0.23527872  90  2697   0.75
11566       NA 1.00 1.00000000 120 11463   1.00

> roc.summary(roc.kosiol)
         score        tp         tn   p     n thresh
10374 0.627481 0.0997921 0.01562397  48   236   0.10
12958 0.480334 0.2494802 0.04389275 120   663   0.25
5957  0.328389 0.4989605 0.12757365 240  1927   0.50
10042 0.182538 0.7484407 0.35259848 360  5326   0.75
15573       NA 1.0000000 1.00000000 481 15105   1.00

> roc.summary(roc.clark)
        score         tp         tn   p    n thresh
2448 0.423730 0.09876543 0.02629696  32  147   0.10
4169 0.298744 0.25000000 0.08336315  81  466   0.25
3759 0.217160 0.50000000 0.17549195 162  981   0.50
5516 0.122820 0.75000000 0.41878354 243 2341   0.75
5760       NA 1.00000000 1.00000000 324 5590   1.00

Using m.weak.psc.count as the score:

> roc.summary(roc.nielsen)
      score   tp         tn   p     n thresh
7478     33 0.10 0.01116636  12   128   0.10
5378     13 0.25 0.05967024  30   684   0.25
4274      6 0.50 0.15283957  60  1752   0.50
11267     2 0.75 0.39692925  90  4550   0.75
11566    NA 1.00 1.00000000 120 11463   1.00

> roc.summary(roc.kosiol)
      score        tp         tn   p     n thresh
859      28 0.0997921 0.01290963  48   195   0.10
2463     14 0.2494802 0.04673949 120   706   0.25
10094     6 0.4989605 0.14902350 240  2251   0.50
1691      1 0.7484407 0.41456471 360  6262   0.75
15573    NA 1.0000000 1.00000000 481 15105   1.00

> roc.summary(roc.clark)
     score         tp         tn   p    n thresh
2154    12 0.09876543 0.02647585  32  148   0.10
1573     5 0.25000000 0.10107335  81  565   0.25
2600     2 0.50000000 0.24418605 162 1365   0.50
921      0 0.75000000 0.53667263 243 3000   0.75
5760    NA 1.00000000 1.00000000 324 5590   1.00

Using m.psc.count:

> roc.summary(roc.nielsen)
      score   tp         tn   p     n thresh
993       3 0.10 0.01038123  12   119   0.10
5759      1 0.25 0.08776062  30  1006   0.25
3975      0 0.50 0.42292594  60  4848   0.50
8122      0 0.75 0.72904126  90  8357   0.75
11566    NA 1.00 1.00000000 120 11463   1.00

> roc.summary(roc.kosiol)
      score        tp          tn   p     n thresh
883       3 0.0997921 0.008672625  48   131   0.10
3145      1 0.2494802 0.055544522 120   839   0.25
4658      0 0.4989605 0.385435286 240  5822   0.50
11992     0 0.7484407 0.791525985 360 11956   0.75
15573    NA 1.0000000 1.000000000 481 15105   1.00

> roc.summary(roc.clark)
     score         tp         tn   p    n thresh
2482     1 0.09876543 0.05974955  32  334   0.10
549      0 0.25000000 0.17674419  81  988   0.25
2374     0 0.50000000 0.45080501 162 2520   0.50
3976     0 0.75000000 0.69731664 243 3898   0.75
5760    NA 1.00000000 1.00000000 324 5590   1.00


SABETI DATA:

Using m.dnds.m0:

> roc.summary(roc.sabeti)
         score        tp        tn   p     n thresh
11874 0.403901 0.0990991 0.1096823  22  2013   0.10
12630 0.291765 0.2477477 0.2060699  55  3782   0.25
7966  0.186794 0.5000000 0.3801013 111  6976   0.50
8435  0.094933 0.7477477 0.6432191 166 11805   0.75
18571       NA 1.0000000 1.0000000 222 18353   1.00

Using p.dnds.m0:

> roc.summary(roc.sabeti)
         score        tp         tn   p     n thresh
10665 0.425685 0.0990991 0.09949327  22  1826   0.10
8223  0.293106 0.2477477 0.20165640  55  3701   0.25
15094 0.185767 0.5000000 0.34915273 111  6408   0.50
10137 0.075824 0.7477477 0.58927696 166 10815   0.75
18573       NA 1.0000000 1.00000000 222 18353   1.00

Using p.weak.psc.count:
> roc.summary(roc.sabeti)
      score        tp         tn   p     n thresh
15405    11 0.0990991 0.03372746  22   619   0.10
4272      4 0.2477477 0.12433935  55  2282   0.25
4105      1 0.5000000 0.34076173 111  6254   0.50
7638      0 0.7477477 0.59930257 166 10999   0.75
18573    NA 1.0000000 1.00000000 222 18353   1.00

Using m.weak.psc.count:

> roc.summary(roc.sabeti)
      score        tp         tn   p     n thresh
10142    22 0.0990991 0.02816978  22   517   0.10
4053      7 0.2477477 0.13289380  55  2439   0.25
15798     3 0.5000000 0.31357271 111  5755   0.50
17325     1 0.7477477 0.55816488 166 10244   0.75
18571    NA 1.0000000 1.00000000 222 18353   1.00


 -> TODO: For each gene, store the MAXIMUM signed LRT value for any codon (post-filtering) and use that for a score.



### 2010-04-16 ###

Plot some mammals sitewise data from EBI machine:

ssh -Nf -R 2222:localhost:22 ssh.sanger.ac.uk

ssh -Nf -L 3307:ens-research:3306 gj1@ssh.sanger.ac.uk

### 2010-04-30 ###

mysql> select tag,count(*),value from sitewise_tag group by tag;
+----------+----------+------------------+
| tag      | count(*) | value            |
+----------+----------+------------------+
| ACC      |   579480 | 3                |
| ACT_SITE |     2707 |  Proton donor (B |
| BINDING  |     2584 |  FMN (By similar |
| CARBOHYD |    15066 |  O-linked (GlcNA |
| DISULFID |    25025 |  By similarity.  |
| DNA_BIND |    41961 |  Basic motif.    |
| DOMAIN   |  4461602 | PF03735          |
| DSSP     |   579480 | C                |
| FILTER   | 14559928 | 0                |
| METAL    |     3983 |  Zinc 1 (By simi |
| MOD_RES  |    34767 |  Phosphothreonin |
| SIGNAL   |    68106 |                  |
| TRANSMEM |   390223 |  Potential.      |
+----------+----------+------------------+
13 rows in set (4 min 0.60 sec)


### 2010-05-10 ###

> summary = sites.summary(db="gj1_2x_57",sites.dir="/nfs/users/nfs_g/gj1/scratch/mammals/output/2010-04-30/2010-04-30_01",filter.fn=filter.fn)
[1] 1
[1] "m"
  parameter_set_id parameter_set_name   total constant synonymous omega_lt_p1
1                1                  m 8585291  1007572    3419503   0.6060252
  omega_lt_p2 omega_lt_p5 omega_lt_one omega_gt_one omega_gt_onep5    positive
1   0.7075732   0.8587602      0.94892   0.05106909     0.02061887 0.007980393
   negative strong.positive strong.negative n.positive n.negative
1 0.8051399     0.003931608       0.7160646      68514    6912360
  n.strong.positive n.strong.negative n.positive.domains
1             33754           6147623               2731
  n.positive.domain.types n.positive.genes
1                    1131             7477



### 2010-05-15 ###

FDR control from simulations:

[1] "2x_g.nh [ 0.01 => 3.9194 0.319334670284299 ]"
[1] "2x_g.nh [ 0.05 => 0.8606 0.660257166450395 ]"
[1] "2x_g.nh [ 0.1 => 0.2093 0.780818685855845 ]"
[1] "2x_g.nh [ 0.2 => -0.0603 0.90645275451221 ]"
[1] "2x_nox.nh [ 0.01 => 3.7736 0.330534531693472 ]"
[1] "2x_nox.nh [ 0.05 => 0.9307 0.63658940397351 ]"
[1] "2x_nox.nh [ 0.1 => 0.1702 0.77779091769158 ]"
[1] "2x_nox.nh [ 0.2 => -0.0668 0.897350993377483 ]"
[1] "2x_p.nh [ 0.01 => 5.7537 0.101044083526682 ]"
[1] "2x_p.nh [ 0.05 => 2.0519 0.324709976798144 ]"
[1] "2x_p.nh [ 0.1 => 0.7344 0.517981438515081 ]"
[1] "2x_p.nh [ 0.2 => 0.0793 0.694199535962877 ]"
[1] "2x_v.nh [ 0.01 => 2.1393 0.794783408020223 ]"
[1] "2x_v.nh [ 0.05 => 0.2186 0.916695392393428 ]"
[1] "2x_v.nh [ 0.1 => -0.015 0.957026312765713 ]"
[1] "2x_v.nh [ 0.2 => -0.8497 0.987475583132253 ]"

### 2010-05-18 ###

FDR control from simulations (100 reps x 1000 sites per alignment, lognormal distribution of omegas (meanlog=-5.39,sdlog=4.01)

thresh_p01
[1] "f [ 0.01 => 6.5105 0.0897858319604613 ]"
[1] "g [ 0.01 => 5.6882 0.120759995337452 ]"
[1] "hi [ 0.01 => 4.2692 0.343332552144364 ]"
[1] "hmrd [ 0.01 => 8.8326 0.0248491302804402 ]"
[1] "l [ 0.01 => 5.4023 0.152512592245519 ]"
[1] "lo [ 0.01 => 4.9926 0.201198026779422 ]"
[1] "m [ 0.01 => 3.2974 0.511327244692207 ]"
[1] "ng [ 0.01 => 3.8681 0.374071891573365 ]"
[1] "np [ 0.01 => 3.0296 0.511149825783972 ]"
[1] "p [ 0.01 => 5.9826 0.0594315245478036 ]"
[1] "s [ 0.01 => 9.3944 0.015193690559035 ]"
> `thresh_p05` = get.fdr.thresholds(data,fdr=0.05,col.names=c('parameter_set_name'))
[1] "f [ 0.05 => 1.6882 0.427983054836432 ]"
[1] "g [ 0.05 => 1.9793 0.357967129036018 ]"
[1] "hi [ 0.05 => 1.0276 0.649402390438247 ]"
[1] "hmrd [ 0.05 => 3.4671 0.169684061057863 ]"
[1] "l [ 0.05 => 1.3961 0.46292608644723 ]"
[1] "lo [ 0.05 => 1.3304 0.502936340145642 ]"
[1] "m [ 0.05 => 0.7143 0.754121693749259 ]"
[1] "ng [ 0.05 => 0.9612 0.656806128461992 ]"
[1] "np [ 0.05 => 0.6506 0.749012775842044 ]"
[1] "p [ 0.05 => 2.9152 0.17723749119098 ]"
[1] "s [ 0.05 => 3.9947 0.127812572488982 ]"
> `thresh_p1` = get.fdr.thresholds(data,fdr=0.1,col.names=c('parameter_set_name'))
[1] "f [ 0.1 => 0.4687 0.62508825606025 ]"
[1] "g [ 0.1 => 0.5634 0.574192796363213 ]"
[1] "hi [ 0.1 => 0.2149 0.78263416920553 ]"
[1] "hmrd [ 0.1 => 1.264 0.340906401609277 ]"
[1] "l [ 0.1 => 0.4044 0.633243528171489 ]"
[1] "lo [ 0.1 => 0.5024 0.640709419779187 ]"
[1] "m [ 0.1 => 0.1108 0.847823508480607 ]"
[1] "ng [ 0.1 => 0.2144 0.775839717147908 ]"
[1] "np [ 0.1 => 0.0708 0.852729384436702 ]"
[1] "p [ 0.1 => 1.5941 0.25369978858351 ]"
[1] "s [ 0.1 => 1.2132 0.384713523544421 ]"



### 2010-06-08 ###

How many full gene trees are in Ensembl:

mysql> select count(*) from protein_tree_node where parent_id=1;
+----------+
| count(*) |
+----------+
|    19298 |
+----------+
1 row in set (0.10 sec)


Covering how many human genes:

mysql> select count(*) from member m, protein_tree_member ptm where ptm.member_id=m.member_id and taxon_id=9606 and source_name="ENSEMBLPEP";
+----------+
| count(*) |
+----------+
|    21317 |
+----------+
1 row in set (1.63 sec)



### 2010-06-09 ###

Dammit!

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select sum(human_gene_count) from stats_genes;
+-----------------------+
| sum(human_gene_count) |
+-----------------------+
|                 77409 |
+-----------------------+
1 row in set (20.39 sec)

mysql> select sum(human_gene_count) from stats_genes where parameter_set_id=1;
+-----------------------+
| sum(human_gene_count) |
+-----------------------+
|                 13927 |
+-----------------------+
1 row in set (0.19 sec)

mysql> select sum(human_gene_count) from bak_stats_genes where parameter_set_id=1;
ERROR 1054 (42S22): Unknown column 'human_gene_count' in 'field list'
mysql> select parameter_set_id,count(*) from stats_sites;
Query aborted by Ctrl+C
ERROR 1317 (70100): Query execution was interrupted
mysql> select parameter_set_id,count(*) from stats_sites group by parameter_set_id;
+------------------+----------+
| parameter_set_id | count(*) |
+------------------+----------+
|                1 |  7447506 |
|                2 |  7919446 |
|                3 |  7632000 |
|                4 |  7944806 |
|                5 |  4809295 |
|                6 |  4887188 |
|                7 |  8633629 |
|                8 |  8477118 |
|                9 |  8324380 |
|               10 |  8622275 |
|               11 |  7692008 |
+------------------+----------+
11 rows in set (2 min 33.04 sec)

